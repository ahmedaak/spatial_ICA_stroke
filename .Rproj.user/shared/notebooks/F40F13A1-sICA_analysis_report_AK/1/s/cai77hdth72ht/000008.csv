"0","# normalize all data (each feature from 0 to 1) according to this source: http://bit.ly/2lRfxS4 "
"0","# create normalize function"
"0","normalize <- function(x) {"
"0","  return ((x - min(x)) / (max(x) - min(x)))}"
"0","# create empty dataframe for normalized data"
"0","HFE_full_norm <- data.frame()"
"0","# loop through each patient and normalize features"
"0","for (s in unique(HFE_full$subject)) {"
"0","HFE_full_norm_sub <- as.data.frame(lapply(HFE_full[HFE_full$subject==(s),4:13], normalize))"
"0","HFE_full_norm_sub <- cbind(HFE_full[HFE_full$subject==(s),1:3], HFE_full_norm_sub)"
"0","HFE_full_norm <- rbind.data.frame(HFE_full_norm, HFE_full_norm_sub)}"
"0","# get normalized data frame of features of HICs & non-HICs"
"0","HFE_full_norm_HIC <- HFE_full_norm[HFE_full_norm$HIC==1,]"
"0","HFE_full_norm_nonHIC <- HFE_full_norm[HFE_full_norm$HIC==0,]"
"0","# take mean of each column (feature)"
"0","HFE_full_norm_HIC_mean <- colMeans(HFE_full_norm_HIC[,4:13], na.rm = T)"
"0","HFE_full_norm_nonHIC_mean <- colMeans(HFE_full_norm_nonHIC[,4:13], na.rm = T)"
"0","# take SEM of each column (feature) based on http://stackoverflow.com/questions/2676554/in-r-how-to-find-the-standard-error-of-the-mean"
"0","HFE_full_norm_HIC_sem <- sapply(HFE_full_norm_HIC[,4:13],function(x)sqrt(var(x, na.rm = T)/length(na.omit(x))))"
"0","HFE_full_norm_nonHIC_sem <- sapply(HFE_full_norm_nonHIC[,4:13],function(x)sqrt(var(x, na.rm = T)/length(na.omit(x))))"
"0","# take SD of each column (feature)"
"0","HFE_full_norm_HIC_sd <- apply(HFE_full_norm_HIC[,4:13],2,sd, na.rm = T)"
"0","HFE_full_norm_nonHIC_sd <- apply(HFE_full_norm_nonHIC[,4:13],2,sd, na.rm = T)"
"0","# get mean +/- 95% CI of each feature"
"0","HFE_full_norm_HIC_meanplus <- HFE_full_norm_HIC_mean+(1.96*HFE_full_norm_HIC_sem)"
"0","HFE_full_norm_HIC_meanminus <- HFE_full_norm_HIC_mean-(1.96*HFE_full_norm_HIC_sem)"
"0","features_HIC <- rbind(HFE_full_norm_HIC_meanplus, HFE_full_norm_HIC_mean, HFE_full_norm_HIC_meanminus)"
"0","HFE_full_norm_nonHIC_meanplus <- HFE_full_norm_nonHIC_mean+(1.96*HFE_full_norm_nonHIC_sem)"
"0","HFE_full_norm_nonHIC_meanminus <- HFE_full_norm_nonHIC_mean-(1.96*HFE_full_norm_nonHIC_sem)"
"0","features_nonHIC <- rbind(HFE_full_norm_nonHIC_meanplus, HFE_full_norm_nonHIC_mean, HFE_full_norm_nonHIC_meanminus)"
"0","# add minimum (0) and maximum (1) rows to all features"
"0","features_HIC <- as.data.frame(rbind(rep(1,10) , rep(0,10) , features_HIC))"
"0","# plot both HIC and non-HIC together"
"0","radar_title = c(""Mean +/- 95% CI of normalized feature values"")"
"0","radarchart(rbind(features_HIC, features_nonHIC), pcol = c(""red"", ""red"", ""red"", ""blue"", ""blue"", ""blue""), plty = c(2, 1, 2, 2, 1, 2), pty = c(32, 16, 32, 32, 16, 32),  title = radar_title, plwd = c(2, 3, 2, 2, 3, 2), vlcex = 1, vlabels = c(""Delay to whole-brain"", ""Delay to sinus"", ""Power 0 - 0.01 Hz"", ""Power 0.01 - 0.025 Hz"", ""Power 0.025 - 0.05 Hz"", ""Power 0.05 - 0.1 Hz"", ""Power 0.1 - 0.15 Hz"", ""Power 0.15 - 0.2 Hz"", ""VT occupancy"", ""Tmax delay""))"
